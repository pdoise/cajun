<app-primary-layout>
  <section class="text-center">
    <div class="row py-5">
      <div class="col-lg-6 col-md-8 mx-auto">
        <h1 class="fw-light app-primary">Cajun Cookbook</h1>
        <p class="lead text-muted app-primary">Louisianaâ€™s Best Recipes-Cajun, Creole, and Southern</p>
        <app-text-filter></app-text-filter>
        <button class="btn btn-primary mt-3"
          (click)="goAddRecipe()">
          Create New Recipe
        </button>
      </div>
    </div>
  </section>

  <section *ngIf="!(recipes$|async)?.length" class="text-center">
    <div class="spinner-grow">
      <span class="visually-hidden">Loading...</span>
    </div>
  </section>

  <section *ngIf="(filteredRecipes$|async)?.length">
    <h3 class="fw-light app-primary">Featured Recipes</h3>
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-md-6 g-4">
      <div class="col-4" class="py-4 bg-light" *ngFor="let recipe of (filteredRecipes$|async) | slice:0:6">
        <div class="card shadow-sm h-100" (click)="goRecipe(recipe)">
          <div class="square-image-wrapper">
            <img *ngIf="recipe.image_url" class="card-img-top square-image" [src]="recipe.image_url">
            <img *ngIf="!recipe.image_url" class="card-img-top square-image" src="/assets/images/no-image.png">
          </div>
          <div class="card-body">
            <h5 class="card-title">{{recipe.name}}</h5>
            <p class="card-text">{{recipe.description}}</p>
          </div>
          <div class="card-footer">
            <div class="d-flex justify-content-between align-items-center">
              <small>Contributor: {{recipe.user?.username}}</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section *ngIf="(filteredRecipes$|async)?.length">
    <h3 class="fw-light app-primary mt-5">All Recipes</h3>
    <div class="row py-4 bg-light">
      <div class="app-table">
        <table class="table table-hover bg-white">
          <colgroup>
            <col width="5%">
            <col width="35%">
            <col width="45%">
            <col width="15%">
          </colgroup>
          <thead>
            <tr>
              <th></th>
              <th>Name</th>
              <th>Description</th>
              <th>Contributor</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let recipe of (filteredRecipes$|async) | slice: (page-1) * pageSize : page * pageSize;" (click)="goRecipe(recipe)">
              <td *ngIf="recipe.image_url"><img class="card-img-table" [src]="recipe.image_url"></td>
              <td *ngIf="!recipe.image_url"><img class="card-img-table" src="/assets/images/no-image.png"></td>
              <td>{{recipe.name}}</td>
              <td>{{recipe.description}}</td>
              <td>{{recipe.user?.username}}</td>
            </tr>
          </tbody>
        </table>
        <pagination
          [records]="recipes$"
          [filteredRecords]="filteredRecipes$"
          label="Total Recipes"
          [page]="page"
          [pageSize]="pageSize"
          (pageChanged)="page = $event">
        </pagination>
      </div>
    </div>
  </section>
</app-primary-layout>
